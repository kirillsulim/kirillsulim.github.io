<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>CV continuous delivery</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="/assets/css/styles.css" />
</head>

<body class="is-preload">
	<div id="wrapper">
		<div id="main">
			<div class="inner">

				<header id="header">
					<span href="#" class="logo">
						<h2>CV continuous delivery</h2>
					</span>
				</header>

				<section id="banner">
					<div class="content">
						<p>TLDR: I’ve used <a href="https://github.com/dogebuild/dogebuild">dogebuild</a> and <a href="https://travis-ci.com/">travis</a> to create continuous integration pipeline for my CV.</p>

<h2 id="the-perfect-cv">The perfect CV</h2>

<p>For many years I’ve learn how to create most effective CV.
I found the talk <a href="https://www.youtube.com/watch?v=BNRVKngFOCY">‎How to write a Perl CV that will get you hired‎</a> by Peter Sergeant very useful as inspiration and my CV was based on this talk ideas for many years.</p>

<h2 id="the-problem">The problem</h2>

<p>At this moment in my career I need 4 CV.
One for developer position and one for team-lead position.
That must be multiplied by two languages (english and russian) and we get 4 CV.</p>

<p>If I would create those CV manually I will face a lot of duplications and as a programmer I try to avoid any duplication.
Also I would like to keep my .pdf files, my linkedin profile and my hh.ru profile consistent.</p>

<h2 id="solution-description">Solution description</h2>

<p>I would like to have .yaml configuration file with all my data.
With every commit in master branch I would like to get updates on my linkedin profile, hh.ru profile and get .pdf files ready to be sent to HR.</p>

<h2 id="model">Model</h2>

<p>All my data is stored in python dataclass names Data:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">Data</span><span class="p">:</span>
    <span class="n">personal</span><span class="p">:</span> <span class="n">Personal</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">contacts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Contacts</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">about_me</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">AboutMe</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">education</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Education</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">work_experience</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">WorkExperience</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>Personal info</strong></p>

<p>Personal info is just a name and surname now.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">Personal</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MultilangStr</span><span class="p">]</span>
    <span class="n">surname</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MultilangStr</span><span class="p">]</span>
</code></pre></div></div>

<p><strong>Contacts</strong></p>

<p>Contacts was the part of personal info but then I decided to separate them to get more simple templates.
Contacts class is very simple:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">Contacts</span><span class="p">:</span>
    <span class="n">phone</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">email</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">telegram</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">github</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">site</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">skype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
</code></pre></div></div>

<p>but there is one hack.
To allow me to get more flexible contacts part building I use special preprocessor to exclude some contacts with fake profiles:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">_contacts_preprocessor</span><span class="p">(</span><span class="n">contacts</span><span class="p">:</span> <span class="n">Contacts</span><span class="p">,</span> <span class="n">profiles</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Contacts</span><span class="p">:</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">contact_type</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">contacts</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="s">"exclude_{contact_type}"</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="n">contact_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">Contacts</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>About me</strong></p>

<p>This is simnple list of <code class="highlighter-rouge">ProfiledMultilangStr</code> but at this moment it is empty for me data file.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">AboutMe</span><span class="p">:</span>
    <span class="n">text_parts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ProfiledMultilangStr</span><span class="p">]]</span>
</code></pre></div></div>

<p><strong>Education</strong></p>

<p>Education part is list of <code class="highlighter-rouge">Educaton</code> class:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">Education</span><span class="p">:</span>
    <span class="n">university</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MultilangStr</span><span class="p">]</span>
    <span class="n">faculty</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MultilangStr</span><span class="p">]</span>
    <span class="n">speciality</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MultilangStr</span><span class="p">]</span>
    <span class="n">from_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">to_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
</code></pre></div></div>

<p>It contains university and faculty names, dates and degree.</p>

<p><strong>Work expirience</strong></p>

<p>Work expirience is list of objects of class with the same name:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">Organisation</span><span class="p">:</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MultilangStr</span><span class="p">]</span>


<span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">WorkExperience</span><span class="p">:</span>
    <span class="n">organisation</span><span class="p">:</span> <span class="n">Organisation</span>
    <span class="n">position</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MultilangStr</span><span class="p">]</span>
    <span class="n">bullets</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ProfiledMultilangStr</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">technologies</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ProfiledStr</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">from_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">to_date</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">current</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="bp">False</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">Organisation</code> is separate class in case I would add additional info in future.</p>

<p>Bullets and technologies list is insired by the talk I mentioned at the beginning.
Its main point that you should include in your CV:</p>

<ul>
  <li>List of keywords to HR or software (this is technologies part)</li>
  <li>Some achievements for Hiring Manager (this goes to bullets)</li>
  <li>Some funny war stories to talk with Tech Interviewer (this part also goes to bullets part)</li>
</ul>

<p>The rest (dates, position) is obligatory part of any CV.</p>

<h3 id="rendering">Rendering</h3>

<p>I use <code class="highlighter-rouge">MultilangStr</code> class to store many languages data in the same place:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">MultilangStr</span><span class="p">:</span>
    <span class="n">ru</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">en</span><span class="p">:</span> <span class="nb">str</span>
</code></pre></div></div>

<p>To allow me to generate sligthly different CV for different positions I’ve created <code class="highlighter-rouge">profile</code> parameter to include or exclude parts of data.
Profile is supported by <code class="highlighter-rouge">ProfiledStr</code> and <code class="highlighter-rouge">ProfiledMultilangStr</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">ProfiledStr</span><span class="p">:</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">profile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>


<span class="o">@</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">ProfiledMultilangStr</span><span class="p">(</span><span class="n">MultilangStr</span><span class="p">):</span>
    <span class="n">profile</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
</code></pre></div></div>

<p>Raw data and rendered data is almost the same, except that all <code class="highlighter-rouge">MultilangStr</code>, <code class="highlighter-rouge">ProfiledStr</code> and <code class="highlighter-rouge">ProfiledMultilangStr</code> became usual strings or will not be included.
So I cheated and my prepared data structure is the same as raw.
To support such behavior I had to use <code class="highlighter-rouge">Union[str, MultilangStr]</code> for any <code class="highlighter-rouge">MultilangStr</code> field. The same is right for the rest of string types.</p>

<p>To get rendered data I use folowing recursive function:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">_resolve_lang_and_profiled_strings</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">lang</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">profiles</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">obj</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="n">o</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">,</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">it</span><span class="p">:</span> <span class="n">_resolve_lang_and_profiled_strings</span><span class="p">(</span><span class="n">it</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">profiles</span><span class="p">),</span> <span class="n">obj</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">MultilangStr</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ProfiledStr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">profile</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">profile</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ProfiledMultilangStr</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">profile</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">profile</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">lang</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Contacts</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">_contacts_preprocessor</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">profiles</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_dataclass</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">args</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_resolve_lang_and_profiled_strings</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">lang</span><span class="p">,</span> <span class="n">profiles</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="n">f</span><span class="s">"Unsupported class {obj.__class__}"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="dogebuild">Dogebuild</h2>

<p>Dogebuild is <a href="https://github.com/dogebuild/dogebuild">general purpose build system</a>.
Dogebuild is designed to be some kind of gradle analog for C++ build.
But its plugin system allow you to use it for any build process.
And <a href="https://dogebuild.readthedocs.io/en/latest/make-mode/">make mode</a> allow you to skip plugin creation and just use tasks for simple builds.</p>

<p>I use dogebuild to manage tasks dependencies, e.g. to build pdf files before load them to github.</p>

<h2 id="pdf-building">Pdf building</h2>

<p>I use Latex markup to generate .pdf files with CV.
I build .tex document with <a href="https://github.com/JelteF/PyLaTeX">pylatex</a>.</p>

<p>To avoid long setup of all Latex installation on travis I decided to use docker container with full Latex installation.
To make pylatex work with docker I’ve used following workaround:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s">"docker"</span><span class="p">,</span> <span class="s">"run"</span><span class="p">,</span> <span class="s">"-it"</span><span class="p">,</span> <span class="s">"--rm"</span><span class="p">,</span> <span class="s">"--user"</span><span class="p">,</span> <span class="n">f</span><span class="s">"{os.getuid()}:{os.getgid()}"</span><span class="p">,</span> <span class="s">"-v"</span><span class="p">,</span> <span class="n">f</span><span class="s">"{out_dir}:{out_dir}"</span><span class="p">,</span>
                       <span class="s">"-w"</span><span class="p">,</span> <span class="n">f</span><span class="s">"{out_dir}"</span><span class="p">,</span> <span class="s">"thomasweise/docker-texlive-full"</span><span class="p">,</span> <span class="s">"/usr/bin/pdflatex"</span><span class="p">]</span>
<span class="n">doc</span><span class="o">.</span><span class="n">generate_pdf</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span> <span class="n">compiler</span><span class="o">=</span><span class="n">command</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">compiler_args</span><span class="o">=</span><span class="n">command</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</code></pre></div></div>

<p>Basically I’ve used <code class="highlighter-rouge">docker</code> as a latex compiler and volumes setup, container name and binary inside container are just compiler arguments.</p>

<h2 id="continuouse-integration">Continuouse integration</h2>

<p>To run CI pipeline I use <a href="https://travis-ci.com">travis</a>.
There is no complex setup for travis as far as dogebuild took all hard work.
All I needed is to install python dependencies, pull docker container and set up credentials for github:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">language</span><span class="pi">:</span> <span class="s">python</span>
<span class="na">python</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">3.8"</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">docker</span>
<span class="na">install</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">pip install -r requirements.txt</span>
  <span class="pi">-</span> <span class="s">docker pull thomasweise/docker-texlive-full</span>
<span class="na">script</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">doge render_pdf --profiles pdf</span>
  <span class="pi">-</span> <span class="s">doge render_md --langs en --profiles md_for_github</span>
  <span class="pi">-</span> <span class="s">doge commit_md_to_github --langs en --profiles md_for_github</span>
  <span class="pi">-</span> <span class="s">doge release_pdf --profiles pdf</span>
<span class="na">branches</span><span class="pi">:</span>
  <span class="na">only</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">master</span>
</code></pre></div></div>

<h3 id="commiting-to-github">Commiting to github</h3>

<p>I would like to my CV be commited at my <a href="https://github.com/kirillsulim/kirillsulim/">easter repo on github</a> so link to my CV is available at my profile.
To make this happen I use following dogebuild task:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">task</span><span class="p">(</span><span class="n">depends</span><span class="o">=</span><span class="p">[</span><span class="s">"render_md"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">commit_md_to_github</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span> <span class="n">md_en</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">md_en</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="n">f</span><span class="s">"Incorrect artifact list md_en {md_en}"</span><span class="p">)</span>

    <span class="n">repo_dir</span> <span class="o">=</span> <span class="n">build_dir</span> <span class="o">/</span> <span class="s">"github"</span>
    <span class="n">repo_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="n">repo_dir</span><span class="p">)</span> <span class="k">as</span> <span class="n">tmp_dir</span><span class="p">:</span>
        <span class="n">repo</span> <span class="o">=</span> <span class="n">Repo</span><span class="o">.</span><span class="n">clone_from</span><span class="p">(</span><span class="n">f</span><span class="s">"https://{github_user}:{github_token}@github.com/kirillsulim/kirillsulim"</span><span class="p">,</span> <span class="n">tmp_dir</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">repo_cv_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">working_tree_dir</span><span class="p">)</span> <span class="o">/</span> <span class="s">"cv.md"</span>
        <span class="n">copy</span><span class="p">(</span><span class="n">md_en</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">repo_cv_file</span><span class="p">)</span>

        <span class="n">repo</span><span class="o">.</span><span class="n">config_writer</span><span class="p">()</span> \
            <span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s">"user"</span><span class="p">,</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">git_user_name</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s">"user"</span><span class="p">,</span> <span class="s">"email"</span><span class="p">,</span> <span class="n">git_user_email</span><span class="p">)</span> \
            <span class="o">.</span><span class="n">release</span><span class="p">()</span>

        <span class="n">repo</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">"."</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">repo</span><span class="o">.</span><span class="n">is_dirty</span><span class="p">():</span>
            <span class="n">repo</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">commit</span><span class="p">(</span><span class="s">"-m"</span><span class="p">,</span> <span class="s">"Automatic CV update"</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">repo</span><span class="o">.</span><span class="n">git</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
</code></pre></div></div>

<p>With <a href="https://github.com/gitpython-developers/GitPython">GitPython</a> I clone my easter repo to temp directory, add rendered .md file with CV and if there is changes commit it and push to github.</p>

<h3 id="releasing-to-github">Releasing to github</h3>

<p>To release builded .pdf files to github I use folowing dogebuild task:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">task</span><span class="p">(</span><span class="n">depends</span><span class="o">=</span><span class="p">[</span><span class="s">"render_pdf"</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">release_pdf</span><span class="p">(</span><span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">pdf</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Path</span><span class="p">]):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">"No artifacts to release"</span><span class="p">)</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">Github</span><span class="p">(</span><span class="n">github_user</span><span class="p">,</span> <span class="n">github_token</span><span class="p">)</span>
    <span class="n">cv_repo</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">get_repo</span><span class="p">(</span><span class="s">"kirillsulim/cv"</span><span class="p">)</span>

    <span class="n">build_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>

    <span class="n">sha</span> <span class="o">=</span> <span class="n">Repo</span><span class="p">(</span><span class="s">"."</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">commit</span><span class="o">.</span><span class="n">hexsha</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">build_time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"</span><span class="si">%</span><span class="s">Y</span><span class="si">%</span><span class="s">m</span><span class="si">%</span><span class="s">d_</span><span class="si">%</span><span class="s">H</span><span class="si">%</span><span class="s">M</span><span class="si">%</span><span class="s">S"</span><span class="p">)</span>
    <span class="n">cv_repo</span><span class="o">.</span><span class="n">create_git_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">sha</span><span class="p">,</span> <span class="s">"commit"</span><span class="p">)</span>

    <span class="n">rel_name</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"</span><span class="si">%</span><span class="s">Y </span><span class="si">%</span><span class="s">b </span><span class="si">%</span><span class="s">d </span><span class="si">%</span><span class="s">H:</span><span class="si">%</span><span class="s">M:</span><span class="si">%</span><span class="s">S </span><span class="si">%</span><span class="s">Z"</span><span class="p">)</span>
    <span class="n">rel_message</span> <span class="o">=</span> <span class="n">f</span><span class="s">"CV pdf builded at {rel_name}"</span>

    <span class="n">release</span> <span class="o">=</span> <span class="n">cv_repo</span><span class="o">.</span><span class="n">create_git_release</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">rel_name</span><span class="p">,</span> <span class="n">rel_message</span><span class="p">,</span> <span class="n">draft</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">pdf</span> <span class="ow">in</span> <span class="n">pdf</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">slugify</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">stem</span><span class="p">)</span> <span class="o">+</span> <span class="s">"."</span> <span class="o">+</span> <span class="n">pdf</span><span class="o">.</span><span class="n">suffix</span>
        <span class="n">label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pdf</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">release</span><span class="o">.</span><span class="n">upload_asset</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">content_type</span><span class="o">=</span><span class="s">"application/pdf"</span><span class="p">)</span>

    <span class="n">release</span><span class="o">.</span><span class="n">update_release</span><span class="p">(</span><span class="n">release</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">release</span><span class="o">.</span><span class="n">body</span><span class="p">,</span> <span class="n">draft</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<p>This task required more fine work and is slightly more complicated.
I use <a href="https://github.com/PyGithub/PyGithub">PyGithub</a> to call github API from python code.
I generate tag based on current date and time, push taht tag to main repo, create draft release associated with taht tag,
publish generated pdf files as release assets (some name tweaking for russian file name is required) and finaly publish my release.</p>

<h2 id="the-bad-part">The bad part</h2>

<p>Linkedin have API to update profile but as far as I know now I cannot get acces to that API.</p>

<p>Hh.ru is better and its API for CV update is free to anyone.
However there was more than a week since I created request to access to that API.</p>

					</div>
				</section>
			</div>
		</div>

		<div id="sidebar">
  <div class="inner">
    <!-- Menu -->
    <nav id="menu">
      <div class="image main round">
        <img src="/assets/images/me.jpeg" alt="Me" />
      </div>
      <header class="major">
        <h2>Menu</h2>
      </header>
      <ul>
        <li><a href="/index.html">Homepage</a></li>
        <li><a href="/projects.html">Projects</a></li>
        <li><a href="/katas.html">Code katas</a></li>
        <li><a href="/blog.html">Blog</a></li>
        <li>
          <span class="opener active">Posts</span>
          <ul>
            
            <li><a href="/2022/09/17/back-online.html">2022-09-17 CV continuous delivery</a></li>
            
            <li><a href="/2020/10/13/cv-continuouse-delivery.html">2020-10-13 CV continuous delivery</a></li>
            
            <li><a href="/2020/09/07/one-man-scrum-iter-1-fail-iter-2-planning.html">2020-09-07 One man scrum. React blog. Iteration 1: failed. Iteration 2: planning.</a></li>
            
            <li><a href="/2020/08/27/one-man-scrum-iter-1-planning.html">2020-08-27 One man scrum. React blog. Iteration 1: planning.</a></li>
            
            <li><a href="/2020/08/26/planning-part-2.html">2020-08-26 React blog project planning part 2</a></li>
            
            <li><a href="/2020/08/25/planning.html">2020-08-25 React blog project planning part 1</a></li>
            
            <li><a href="/2020/08/05/python-strict-yaml-deserialization.html">2020-08-05 Strict YAML deserialization with marshmallow</a></li>
            
            <li><a href="/2020/06/18/how-my-blog-works.html">2020-06-18 How my blog works</a></li>
            
            <li><a href="/2019/12/17/second-planning.html">2019-12-17 Second planning attempt</a></li>
            
            <li><a href="/2019/12/14/planning.html">2019-12-14 Planning</a></li>
            
          </ul>
        </li>
      </ul>
    </nav>

    <!-- Footer -->
    <footer id="footer">
      <p class="copyright">Design based on: <a href="https://html5up.net">HTML5 UP</a>.</p>
    </footer>

  </div>
</div>
	</div>

	<!-- Scripts -->
	<script src="/assets/js/jquery.min.js"></script>
	<script src="/assets/js/browser.min.js"></script>
	<script src="/assets/js/breakpoints.min.js"></script>
	<script src="/assets/js/util.js"></script>
	<script src="/assets/js/main.js"></script>

</body>

</html>